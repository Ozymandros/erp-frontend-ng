<div class="page-header" style="margin-bottom: 24px; display: flex; justify-content: space-between; align-items: center;">
  <h1>Sales Orders</h1>
  <div>
    <button nz-button (click)="exportToXlsx()" style="margin-right: 8px;">
      <i nz-icon nzType="file"></i> Export XLSX
    </button>
    <button nz-button (click)="exportToPdf()" style="margin-right: 8px;">
      <i nz-icon nzType="file"></i> Export PDF
    </button>
    <button nz-button nzType="primary" routerLink="/sales/orders/new">
      <i nz-icon nzType="plus"></i> New Order
    </button>
  </div>
</div>

<nz-card>
  <div style="margin-bottom: 16px; display: flex; gap: 16px;">
    <nz-input-group [nzPrefix]="prefixIconSearch">
      <input type="text" nz-input placeholder="Search orders..." [(ngModel)]="searchTerm" (ngModelChange)="onSearch()" />
    </nz-input-group>
    <ng-template #prefixIconSearch>
      <i nz-icon nzType="search"></i>
    </ng-template>
  </div>

  <nz-table
    #basicTable
    [nzData]="orders"
    [nzLoading]="loading"
    [nzTotal]="total"
    [(nzPageIndex)]="pageIndex"
    [(nzPageSize)]="pageSize"
    [nzFrontPagination]="false"
    (nzPageIndexChange)="loadOrders()"
    (nzPageSizeChange)="loadOrders()"
  >
    <thead>
      <tr>
        <th>Order #</th>
        <th>Customer</th>
        <th>Date</th>
        <th>Total Amount</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of basicTable.data">
        <td><strong>{{ data.orderNumber }}</strong></td>
        <td>{{ data.customerName }}</td>
        <td>{{ data.orderDate | date:'shortDate' }}</td>
        <td>\${{ data.totalAmount.toFixed(2) }}</td>
        <td>
          <nz-tag [nzColor]="getStatusColor(data.status)">
            {{ data.status }}
          </nz-tag>
        </td>
        <td>
          <a [routerLink]="['/sales/orders', data.id]" style="margin-right: 8px;">View</a>
          <a
            nz-popconfirm
            nzPopconfirmTitle="Are you sure cancel this order?"
            (nzOnConfirm)="deleteOrder(data.id)"
            nzPopconfirmPlacement="left"
            style="color: #ff4d4f;"
          >Cancel</a>
        </td>
      </tr>
    </tbody>
  </nz-table>
</nz-card>
